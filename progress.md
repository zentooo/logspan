# 開発進捗管理

## フェーズ1: 基本機能の実装

### 1.1 プロジェクトの初期セットアップ
- [x] リポジトリの作成
- [x] 基本的なパッケージ構造の設定
- [x] 依存関係の管理（`go.mod`）

### 1.2 コアインターフェースの実装
- [x] `Logger` インターフェースの定義
- [x] `LogEntry` 構造体の実装
- [x] 基本的な設定構造体（`Config`）の実装
- [x] JSONフィールド名の統一（小文字化：timestamp, level, message, fields, tags）

### 1.3 ダイレクトロガーの実装
- [x] 即時出力機能の実装
- [x] 基本的なログレベル（Debug, Info, Warn, Error, Critical）のサポート
- [x] ログレベルによるフィルター機能の実装
- [x] 構造化ログ出力への対応（context loggerと同じJSON形式、常にlines=1エントリ）
- [x] DirectLoggerのユニットテストの作成
  - [x] 1. 基本的なログ出力のテスト
  - [x] 2. ログレベルフィルタリングのテスト
  - [x] 3. 出力先設定のテスト
  - [x] 4. 並行処理安全性のテスト
  - [x] 5. エラーケースのテスト
  - [x] 6. 構造化ログ出力のテスト

## フェーズ2: コンテキストロガーの実装

### 2.1 コンテキスト管理機能
- [x] `context.Context` との連携機能
- [x] ログの集約機能の実装
- [x] コンテキストへのロガー注入・取得機能

### 2.2 ログフォーマッターの実装
- [x] JSONフォーマッターの基本実装
- [x] カスタムフォーマッターのインターフェース設計

## フェーズ3: 拡張機能の実装

### 3.1 ミドルウェア機構
- [x] 1. ミドルウェアインターフェースの設計と実装
  - [x] 1.1 ミドルウェアインターフェースの定義（middleware.go）
  - [x] 1.2 ミドルウェアチェーンの実装
  - [x] 1.3 ミドルウェア登録・管理機能の実装
- [x] 2. 基本的なミドルウェアの実装
  - [x] 2.1 パスワードマスキングミドルウェアの実装
- [x] 3. ミドルウェア機構のテスト
  - [x] 3.1 ミドルウェアインターフェースのユニットテスト
  - [x] 3.2 パスワードマスキングミドルウェアのテスト
  - [x] 3.3 ミドルウェアチェーンのテスト

### 3.2 DataDog連携
- [x] DataDog Standard Attributes対応
- [x] フォーマッターの拡張

## フェーズ5: HTTPミドルウェアとテスト

### 5.1 HTTPミドルウェア
- [ ] リクエストコンテキストの自動セットアップ
- [ ] 基本的なHTTPリクエスト情報の収集

### 5.2 テストとドキュメント
- [ ] ユニットテストの作成
- [ ] 統合テストの作成
- [ ] ドキュメントの整備

## フェーズ6: 最適化とリリース準備

### 6.1 パフォーマンス最適化
- [ ] メモリ使用量の最適化
- [ ] ログ出力の非同期処理の実装

### 6.2 リリース準備
- [ ] サンプルコードの作成
- [ ] READMEの整備
- [ ] バージョン管理の設定

## 技術的な注意点

### エラーハンドリング
- [ ] 適切なエラー型の定義
- [ ] エラーメッセージの国際化対応

### パフォーマンス
- [ ] ログ出力の非同期処理
- [ ] メモリプールの活用

### テスト容易性
- [ ] インターフェースの適切な設計
- [ ] モック可能な構造

### 後方互換性
- [ ] 既存の `logone-go` との互換性維持
- [ ] 段階的な機能追加

## ミドルウェア機構実装方針

### 設計原則
- 責任チェーンパターンを採用（`LogEntry` を受け取り、変更して次のミドルウェアに渡す）
- 設定可能で拡張可能な設計
- パフォーマンスへの影響を最小限に抑制
- 既存のコードへの影響を最小限に抑制

### 実装順序
1. ミドルウェアインターフェースの定義
2. ミドルウェアチェーンの実装
3. 基本ミドルウェアの実装
4. テストの作成

## 進捗状況

- 開始日: [未設定]
- 現在のフェーズ: フェーズ3（ミドルウェア機構実装完了）
- 完了タスク数: 10
- 残りタスク数: 27
- 次のタスク: 3.2 DataDog連携 - フォーマッターの拡張